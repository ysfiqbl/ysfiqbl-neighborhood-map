$(document).ready(function(){function a(a,b,c){var d=this;d.marker=new google.maps.Marker({position:new google.maps.LatLng(b,c),map:a,draggable:!0}),d.title=ko.observable(""),d.category=ko.observable(),d.labels=ko.observableArray(),d.lat=ko.observable(b),d.lng=ko.observable(c)}(function(){this.setCategory=function(a){this.category(a)},this.addLabel=function(a){this.categories.indexOf(category)<0?this.categories.push(category):alert("Location already belongs to category.")},this.removeLabel=function(a){this.categories.remove(a)}}).call(a.prototype);var b=function(){var b=this;b.localStoreLocations=[],b.allLocations=ko.observableArray(),b.visibleLocations=ko.observableArray(),b.map,b.infowindow=void 0,b.locationSearchQuery=ko.observable(""),b.locationSearchSuggestions=ko.computed(function(){var a=b.locationSearchQuery().toLowerCase();return ko.utils.arrayFilter(b.localStoreLocations,function(b){return b.title.toLowerCase().indexOf(a)>-1})}),b.showLocationSuggestions=ko.observable(!1),b.initializeSearchText=function(){b.showLocationSuggestions(!0)},b.showLocationSearchDiv=ko.computed(function(){var a=!1;return a=b.showLocationSuggestions()===!1?!1:""==b.locationSearchQuery()?!1:b.locationSearchSuggestions().length>0?!0:!1}),b.initialize=function(){b.mapOptions={zoom:8,center:new google.maps.LatLng(-34.397,150.644),panControl:!0,panControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_BOTTOM}},b.map=new google.maps.Map(document.getElementById("map-canvas"),b.mapOptions),b.loadLocations(),google.maps.event.addListener(b.map,"click",function(c){var d=new a(b.map,c.latLng.lat(),c.latLng.lng());b.addLocationEventListeners(d),google.maps.event.trigger(d.marker,"click")})},google.maps.event.addDomListener(window,"load",b.initialize),b.removeLocation=function(a){a.marker.setMap(null);var c=b.allLocations.indexOf(a);c>-1&&(b.allLocations.remove(a),b.localStoreLocations.splice(c,1),localStorage.locations=JSON.stringify(b.localStoreLocations))},b.addLocationEventListeners=function(a){google.maps.event.addListener(a.marker,"click",function(){b.showLocation(a),b.locationSearchQuery("")})},b.showLocation=function(c){if(b.showSuggestions(!1),!(c instanceof a)){var d=b.localStoreLocations.indexOf(c);if(!(d>-1))return-1;c=b.allLocations()[d]}if(b.locationSearchQuery(c.title()),void 0===b.infowindow||b.infowindow.marker!==c.marker){void 0!==b.infowindow&&b.infowindow.close();var e=document.createElement("div"),f=document.createElement("input");f.type="text",f.value=c.title(),e.appendChild(f);var g=document.createElement("button");g.innerHTML="Save",g.addEventListener("click",function(a){return function(){a.title(f.value),b.saveLocation(a)}}(c)),e.appendChild(g);var h=document.createElement("button");h.innerHTML="Delete",h.addEventListener("click",function(a){return function(){b.removeLocation(a)}}(c)),e.appendChild(h),b.infowindow=new google.maps.InfoWindow({content:e}),b.infowindow.marker=c.marker,b.infowindow.open(b.map,c.marker)}},b.saveLocation=function(a){var c=b.allLocations.indexOf(a),d={title:a.title(),lat:a.marker.getPosition().lat(),lng:a.marker.getPosition().lng(),labels:a.labels(),category:a.category()};c>-1?(b.allLocations[c]=a,b.localStoreLocations[c]=d):(b.allLocations.push(a),b.localStoreLocations.push(d)),localStorage.locations=JSON.stringify(b.localStoreLocations)},b.loadLocations=function(){if(localStorage.locations){b.localStoreLocations=JSON.parse(localStorage.locations);for(var c=0;c<b.localStoreLocations.length;c++){var d=b.localStoreLocations[c],e=new a(b.map,d.lat,d.lng);e.title(d.title),b.addLocationEventListeners(e),b.allLocations.push(e)}}}};ko.applyBindings(new b)});